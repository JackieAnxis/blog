<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Jiacheng Pan&#39;s Blog">
  <meta name="keyword" content>
  <!-- <link rel="shortcut icon" href="/blog/img/favicon.ico"> -->
  <link rel="shortcut icon" href="https://avatars2.githubusercontent.com/u/19246028?s=460&amp;u=8d4f9462069e17c42c9f7e460369ac703146ceb9&amp;v=4">

  <title>
     reduxæµ…æ - Jiacheng Pan&#39;s Blog 
  </title>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/blog/css/aircloud.css"> <link rel="stylesheet" href="/blog/css/gitment.css">
  <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
  <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
  <!-- ga & ba script hoook -->
  <script></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body>

<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> ğŸ¶ ç”Ÿå‘½å› ä½ è€Œç«çƒ­ ğŸ’¯ </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        <div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <a href="http://panjiacheng.site"><img
                    src="https://avatars2.githubusercontent.com/u/19246028?s=460&amp;u=8d4f9462069e17c42c9f7e460369ac703146ceb9&amp;v=4" /></a>
        </div>
        <div class="name">
            <a href="http://panjiacheng.site">
                <i>Jiacheng Pan</i>
            </a>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <!-- <li >
                <a
                    href="http://panjiacheng.site">
                    <i class="iconfont icon-shouye2"></i>
                    <span>ğŸ¡&nbsp;&nbsp;ä¸»é¡µ</span>
                </a>
            </li> -->
            <li >
                <a href="/blog/">
                    <!-- <i class="iconfont icon-guidang1"></i> -->
                    <span>âŒ¨ï¸&nbsp;&nbsp;åšå®¢</span>
                </a>
            </li>
            <li >
                <a href="/blog/author">
                    <!-- <i class="iconfont icon-guanyu2"></i> -->
                    <span>ğŸ“¦&nbsp;&nbsp;åˆ†ç±»</span>
                </a>
            </li>
            <li >
                <a href="/blog/tags">
                    <!-- <i class="iconfont icon-biaoqian1"></i> -->
                    <span>ğŸ“Œ&nbsp;&nbsp;æ ‡ç­¾</span>
                </a>
            </li>
            <li >
                <a href="/blog/archives">
                    <!-- <i class="iconfont icon-guidang"></i> -->
                    <span>ğŸ“…&nbsp;&nbsp;æ—¶é—´</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <!-- <i class="iconfont icon-sousuo1"></i> -->
                    <span>ğŸ”&nbsp;&nbsp;æœç´¢</span>
                </a>
            </li>
            
        </ul>
    </div>
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input" />
            <span id="begin-search">æœç´¢</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i> ğŸ¶ ç”Ÿå‘½å› ä½ è€Œç«çƒ­ ğŸ’¯ </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        <div class="post-container">
    <div class="post-title">
        reduxæµ…æ
    </div>

    <div class="post-meta">
        <!-- <span
            class="attr">å‘å¸ƒäºï¼š<span>2018-12-04 13:04:00</span></span> -->
        <span class="attr">å‘å¸ƒäºï¼š<span>2018-12-04</span></span>
        <span class="attr"><a class="tag" href="/blog/author/#FrontEnd"
                title="FrontEnd">FrontEnd</a></span>
        
        <span class="attr">/
            
            <a class="tag" href="/blog/tags/#FrontEnd" title="FrontEnd">FrontEnd</a>
            <span>/</span>
            
            <a class="tag" href="/blog/tags/#React" title="React">React</a>
            <span>/</span>
            
            
        </span>
        <span class="attr">è®¿é—®ï¼š<span id="busuanzi_value_page_pv"></span>
        </span>
        </span>
    </div>
    <div class="post-content ">
        <p>è¯»å®Œäº†èƒ¡å­å¤§å“ˆçš„<a href="http://huziketang.mangojuice.top/books/react/" target="_blank" rel="noopener">React.js å°ä¹¦</a>åï¼Œæ€»ç»“ä¸€ä¸‹å¯¹ redux çš„æ–°ç†è§£å§ï¼Œä¸»è¦æ˜¯ storeï¼Œconnectï¼Œreducerï¼Œprovider ç­‰å†…å®¹çš„ä¸€äº›æµ…è§ã€‚</p>
<p>redux çš„å‡ºç°ï¼Œäº‹å®ä¸Šä¸ºäº†è§£å†³çŠ¶æ€ç®¡ç†çš„é—®é¢˜ã€‚æœ€ç›´æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œå¦‚ä½•åœ¨å„ä¸ªç»„ä»¶ä¹‹é—´å…±äº«çŠ¶æ€ï¼ˆå³ç»„ä»¶é—´é€šè®¯ï¼‰ã€‚</p>
<h4 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h4><p>redux åº”å¯¹ä¸Šè¿°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯å°†è¿™äº›éœ€è¦å…±äº«çš„çŠ¶æ€æ”¾ç½®åœ¨æ ¹ç»„ä»¶çš„<a href="http://huziketang.mangojuice.top/books/react/lesson29" target="_blank" rel="noopener">context</a>ä¸­ï¼ˆç±»ä¼¼äºå…¨å±€å˜é‡ï¼‰ï¼Œå…¶å­ç»„ä»¶éƒ½èƒ½è·å–åˆ° contextã€‚</p>
<p>å…·ä½“çš„åšæ³•ï¼Œå…¶å®æ˜¯å°† Index ç»„ä»¶ï¼ˆæ ¹ç»„ä»¶ï¼‰åŒ…è£…æˆ Provider ç»„ä»¶ï¼š</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">Provider</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    store: PropTypes.object,</span><br><span class="line">    children: PropTypes.any,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> childContextTypes = &#123;</span><br><span class="line">    store: PropTypes.object,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  getChildContext() &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      store: <span class="keyword">this</span>.props.store,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.children&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª Provider ç»„ä»¶ï¼Œä¸ºæ•´ä¸ªç»„ä»¶æ ‘æ·»åŠ äº† storeï¼Œä»»ä½•å­ç»„ä»¶éƒ½èƒ½è·å–åˆ° store</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">  &lt;Index /&gt;</span><br><span class="line">&lt;<span class="regexp">/Provider&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h4><p>store ç®—æ˜¯ç»„ä»¶çš„çŠ¶æ€ç®¡ç†å™¨ï¼Œä¹Ÿæ˜¯æ•´ä¸ª redux çš„æ ¸å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">const</span> listeners = [];</span><br><span class="line">  <span class="keyword">const</span> subscribe = <span class="function">(<span class="params">listener</span>) =&gt;</span> listeners.push(listener);</span><br><span class="line">  <span class="keyword">const</span> getState = <span class="function"><span class="params">()</span> =&gt;</span> state;</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">    state = reducer(state, action);</span><br><span class="line">    listeners.forEach(<span class="function">(<span class="params">listener</span>) =&gt;</span> listener());</span><br><span class="line">  &#125;;</span><br><span class="line">  dispatch(&#123;&#125;);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    getState,</span><br><span class="line">    dispatch,</span><br><span class="line">    subscribe,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>store åšçš„äº‹æƒ…åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä»¶ï¼š</p>
<ol>
<li>getStateï¼šç”¨äºè·å–å½“å‰çš„çŠ¶æ€</li>
<li>dispatchï¼šä¿®æ”¹çŠ¶æ€ï¼ˆreducerï¼‰ï¼Œå¹¶å°†äº‹ä»¶åˆ†å‘ç»™æ‰€æœ‰ç›‘å¬å™¨</li>
<li>subscribeï¼šè®¢é˜…äº‹ä»¶ï¼Œç”¨å®ƒæ¥å¢åŠ æ–°çš„ç›‘å¬å™¨</li>
</ol>
<h4 id="Reducer"><a href="#Reducer" class="headerlink" title="Reducer"></a>Reducer</h4><p>reducer ç”±ç”¨æˆ·è‡ªå·±å®šä¹‰ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‰è€…æ˜¯è€çŠ¶æ€ï¼Œåè€…æ˜¯ä¸€ä¸ª actionã€‚</p>
<p>å®ƒåšçš„äº‹æƒ…ä»…ä»…æ˜¯ï¼š<strong>åˆå§‹åŒ–å’Œè®¡ç®—æ–°çš„ state</strong>ï¼›æ ¹æ® action çš„ä¿¡æ¯ï¼Œreducer ä¿®æ”¹å¯¹åº”çš„çŠ¶æ€ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çŠ¶æ€ï¼ˆå…¨æ–°çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯åœ¨è€å¯¹è±¡ä¸Šä¿®æ”¹ï¼‰ã€‚</p>
<p>ä¸¾ä¸ªä¹¦ä¸­çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> themeReducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!state)</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      themeColor: <span class="string">"red"</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"CHANGE_COLOR"</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">themeColor</span>: action.themeColor &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>reducerï¼ŒæŒ‰ç…§è§„å®šï¼Œåº”è¯¥æ˜¯ä¸€ä¸ª<a href="http://huziketang.mangojuice.top/books/react/lesson32" target="_blank" rel="noopener">çº¯å‡½æ•°</a>ã€‚</p>
<h4 id="Connect"><a href="#Connect" class="headerlink" title="Connect"></a>Connect</h4><p>connect ä»æœ¬è´¨ä¸Šè®²ï¼Œæ˜¯ä¸€ä¸ª<a href="http://huziketang.com/books/react/lesson28" target="_blank" rel="noopener">é«˜é˜¶ç»„ä»¶</a>ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥ç†è§£ä¸ºï¼š</p>
<ol>
<li>å­ç»„ä»¶é€šè¿‡ connect æˆä¸ºé«˜é˜¶ç»„ä»¶åï¼Œå…¶å†…éƒ¨ä¸ç”¨å†å»å¯¹ context è¿›è¡Œè¯»å†™ï¼ˆé™ä½ä¾èµ–æ€§ï¼‰</li>
<li>ç»è¿‡ connect åï¼Œä» context çš„ store é‡Œé¢è¯»å–åˆ°çš„ state/dispatch/propsï¼Œå°†ä¼šç»Ÿä¸€ä»¥ props çš„çŠ¶æ€ä¼ å…¥å­ç»„ä»¶</li>
</ol>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> connect = <span class="function">(<span class="params">mapStateToProps, mapDispatchToProps</span>) =&gt;</span> (</span><br><span class="line">  WrappedComponent</span><br><span class="line">) =&gt; &#123;</span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Connect</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> contextTypes = &#123;</span><br><span class="line">      store: PropTypes.object,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">      <span class="keyword">super</span>();</span><br><span class="line">      <span class="keyword">this</span>.state = &#123;</span><br><span class="line">        allProps: &#123;&#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _updateProps() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; store &#125; = <span class="keyword">this</span>.context;</span><br><span class="line">      <span class="keyword">let</span> stateProps = mapStateToProps</span><br><span class="line">        ? mapStateToProps(store.getState(), <span class="keyword">this</span>.props)</span><br><span class="line">        : &#123;&#125;; <span class="comment">// é˜²æ­¢ mapStateToProps æ²¡æœ‰ä¼ å…¥</span></span><br><span class="line">      <span class="keyword">let</span> dispatchProps = mapDispatchToProps</span><br><span class="line">        ? mapDispatchToProps(store.dispatch, <span class="keyword">this</span>.props)</span><br><span class="line">        : &#123;&#125;; <span class="comment">// é˜²æ­¢ mapDispatchToProps æ²¡æœ‰ä¼ å…¥</span></span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        allProps: &#123;</span><br><span class="line">          ...stateProps,</span><br><span class="line">          ...dispatchProps,</span><br><span class="line">          ...this.props,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    componentWillMount() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; store &#125; = <span class="keyword">this</span>.context;</span><br><span class="line">      <span class="keyword">this</span>._updateProps();</span><br><span class="line">      store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>._updateProps());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.state.allProps</span>&#125; /&gt;</span>;</span></span><br><span class="line"><span class="xml">    &#125;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">  return Connect;</span></span><br><span class="line"><span class="xml">&#125;;</span></span><br></pre></td></tr></table></figure>

        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>
    </div>
    
    
    <div class="index-right">
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Provider"><span class="toc-text">Provider</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Store"><span class="toc-text">Store</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reducer"><span class="toc-text">Reducer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Connect"><span class="toc-text">Connect</span></a></li></ol>
</div>
    </div>
    
</div>

<footer class="footer">
  <ul class="list-inline text-center">
         
  </ul>
  
  <p>
    <a href="http://panjiacheng.site">@Jiacheng Pan</a> Created By
    <a href="https://hexo.io/">Hexo</a> Theme
    <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a>
    <a href="https://github.com/aircloud">@Xiaotao</a>
  </p>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/blog/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/blog/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script type="text/javascript">
       (function() {
           if (typeof LivereTower === 'function') { return; }

           var j, d = document.getElementById('lv-container');

           d.setAttribute('data-id','city');
           d.setAttribute('data-uid' , 'MTAyMC8yOTk2MC82NTI1');

           j = document.createElement('script');
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;

           d.appendChild(j);
       })();
    </script>
    <noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
    </div>

</html>
